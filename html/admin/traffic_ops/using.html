


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Traffic Ops - Using &mdash; Traffic Control 3.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Managing Traffic Ops Extensions" href="extensions.html" />
    <link rel="prev" title="Traffic Ops - Configuring" href="configuration.html" />
    <link href="../../_static/theme_overrides.css" rel="stylesheet" type="text/css"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Traffic Control
          

          
            
            <img src="../../_static/ATC-SVG-FULL-WHITE.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../basics/index.html">CDN Basics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Traffic Control Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Traffic Ops - Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_from_10_to_20.html">Traffic Ops - Migrating from 1.x to 2.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration_from_20_to_22.html">Traffic Ops - Migrating from 2.0 to 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Traffic Ops - Configuring</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Traffic Ops - Using</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-traffic-ops-menu">The Traffic Ops Menu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#health">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delivery-services">Delivery Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#servers">Servers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tools">Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#misc">Misc</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changelog">ChangeLog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#help">Help</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#index-2">Health</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-health-table">The Health Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#graph-view">Graph View</a></li>
<li class="toctree-l4"><a class="reference internal" href="#server-checks">Server Checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daily-summary">Daily Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#server">Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#server-types">Server Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delivery-service">Delivery Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delivery-service-types">Delivery Service Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#federations">Federations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#header-rewrite-options-and-dscp">Header Rewrite Options and DSCP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#token-based-authentication">Token Based Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parent-selection">Parent Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qstring-handling">Qstring Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multi-site-origin">Multi Site Origin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#traffic-router-profile">Traffic Router Profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regex-remap-expression">Regex Remap Expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delivery-service-regexp">Delivery Service Regexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#static-dns-entries">Static DNS Entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#server-assignments">Server Assignments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-coverage-zone-file-and-asn-table">The Coverage Zone File and ASN Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-deep-coverage-zone-file">The Deep Coverage Zone File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parameters-and-profiles">Parameters and Profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generate-iso">Generate ISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#queue-updates-and-snapshot-crconfig">Queue Updates and Snapshot CRConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#invalidate-content">Invalidate Content</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manage-dnssec-keys">Manage DNSSEC Keys</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#activate-deactivate-dnssec-for-a-cdn">Activate/Deactivate DNSSEC for a CDN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-keys">Generate Keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regenerate-ksk">Regenerate KSK</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generation-of-keys-for-new-delivery-services">Generation of keys for new Delivery Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regeneration-of-expiring-keys-for-a-delivery-service">Regeneration of expiring keys for a Delivery Service</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="extensions.html">Managing Traffic Ops Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal/installation.html">Traffic Portal Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal/usingtrafficportal.html">Traffic Portal - Using</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal/default_profiles.html">Default Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_monitor.html">Traffic Monitor Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_router.html">Traffic Router Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_router/migrationto2-3.html">Traffic Router - Migrating to 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_stats.html">Traffic Stats Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_server.html">Traffic Server Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_vault.html">Traffic Vault Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick_howto/index.html">Quick How To Guides</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer’s Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">APIs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Traffic Control</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator’s Guide</a> &raquo;</li>
        
      <li>Traffic Ops - Using</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/admin/traffic_ops/using.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="traffic-ops-using">
<span id="to-using"></span><h1>Traffic Ops - Using<a class="headerlink" href="#traffic-ops-using" title="Permalink to this headline">¶</a></h1>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The Traffic Ops UI is deprecated, and will be removed entirely in the next major release (4.0). A much better way to interact with the CDN is to <a class="reference internal" href="../traffic_portal/usingtrafficportal.html#usingtrafficportal"><span class="std std-ref">use Traffic Portal</span></a>, which is the the only UI that will be receiving updates for the foreseeable future.</p>
</div>
<div class="section" id="the-traffic-ops-menu">
<h2>The Traffic Ops Menu<a class="headerlink" href="#the-traffic-ops-menu" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="id20">
<img alt="The Traffic Ops Landing Page" src="../../_images/12m.png" />
<p class="caption"><span class="caption-text">The Traffic Ops Landing Page</span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
<p>The following tabs are available in the menu at the top of the Traffic Ops user interface.</p>
<div class="section" id="health">
<span id="index-0"></span><h3>Health<a class="headerlink" href="#health" title="Permalink to this headline">¶</a></h3>
<p>Information on the health of the system. Hover over this tab to get to the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Table View</p></td>
<td><p>A real time view into the main performance indicators of the CDNs managed by Traffic Control.
This view is sourced directly by the Traffic Monitor data and is updated every 10 seconds.
This is the default screen of Traffic Ops.
See <a class="reference internal" href="#health-table"><span class="std std-ref">The Health Table</span></a> for details.</p></td>
</tr>
<tr class="row-odd"><td><p>Graph View</p></td>
<td><p>A real graphical time view into the main performance indicators of the CDNs managed by Traffic Control.
This view is sourced by the Traffic Monitor data and is updated every 10 seconds.
On loading, this screen will show a history of 24 hours of data from Traffic Stats
See <a class="reference internal" href="#health-graph"><span class="std std-ref">Graph View</span></a> for details.</p></td>
</tr>
<tr class="row-even"><td><p>Server Checks</p></td>
<td><p>A table showing the results of the periodic check extension scripts that are run. See <a class="reference internal" href="#server-checks"><span class="std std-ref">Server Checks</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Daily Summary</p></td>
<td><p>A graph displaying the daily peaks of bandwidth, overall bytes served per day, and overall bytes served since initial installation
per CDN.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="delivery-services">
<h3>Delivery Services<a class="headerlink" href="#delivery-services" title="Permalink to this headline">¶</a></h3>
<p>The main Delivery Service table. This is where you Create/Read/Update/Delete Delivery Services of all types. Hover over to get the following sub option:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Federations</p></td>
<td><p>Add/Edit/Delete Federation Mappings.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="servers">
<h3>Servers<a class="headerlink" href="#servers" title="Permalink to this headline">¶</a></h3>
<p>The main Servers table. This is where you Create/Read/Update/Delete servers of all types.  Click the main tab to get to the main table, and hover over to get these sub options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Upload Server CSV</p></td>
<td><p>Bulk add of servers from a csv file. See <span class="xref std std-ref">bulkserver</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>Parameters and Profiles can be edited here. Hover over the tab to get the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Global Profile</p></td>
<td><p>The table of global parameters. See <a class="reference internal" href="configuration.html#param-prof"><span class="std std-ref">Profile Parameters</span></a>. This is where you Create/Read/Update/Delete parameters in the Global profile</p></td>
</tr>
<tr class="row-odd"><td><p>All Cache Groups</p></td>
<td><p>The table of all parameters <em>that are assigned to a cachegroup</em> - this may be slow to pull up, as there can be thousands of parameters.</p></td>
</tr>
<tr class="row-even"><td><p>All Profiles</p></td>
<td><p>The table of all parameters <em>that are assigned to a profile</em> - this may be slow to pull up, as there can be thousands of parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>Select Profile</p></td>
<td><p>Select the parameter list by profile first, then get a table of just the parameters for that profile.</p></td>
</tr>
<tr class="row-even"><td><p>Export Profile</p></td>
<td><p>Profiles can be exported from one Traffic Ops instance to another using ‘Select Profile’ and under the “Profile Details” dialog for the desired profile</p></td>
</tr>
<tr class="row-odd"><td><p>Import Profile</p></td>
<td><p>Profiles can be imported from one Traffic Ops instance to another using the button “Import Profile” after using the “Export Profile” feature</p></td>
</tr>
<tr class="row-even"><td><p>Orphaned Parameters</p></td>
<td><p>A table of parameters that are not associated to any profile of cache group. These parameters either should be deleted or associated with a profile of cache group.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tools">
<h3>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h3>
<p>Tools for working with Traffic Ops and it’s servers. Hover over this tab to get the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Generate ISO</p></td>
<td><p>Generate a bootable image for any of the servers in the Servers table (or any server for that matter). See <a class="reference internal" href="#generate-iso"><span class="std std-ref">Generate ISO</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Queue Updates</p></td>
<td><p>Send Updates to the caches. See <a class="reference internal" href="#queue-updates"><span class="std std-ref">Queue Updates and Snapshot CRConfig</span></a></p></td>
</tr>
<tr class="row-even"><td><p>DB Dump</p></td>
<td><p>Backup the Database to a .sql file.</p></td>
</tr>
<tr class="row-odd"><td><p>Snapshot CRConfig</p></td>
<td><p>Send updates to the Traffic Monitor / Traffic Router servers.  See <a class="reference internal" href="#queue-updates"><span class="std std-ref">Queue Updates and Snapshot CRConfig</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Invalidate Content</p></td>
<td><p>Invalidate or purge content from all caches in the CDN. See <a class="reference internal" href="#purge"><span class="std std-ref">Invalidate Content</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Manage DNSSEC keys</p></td>
<td><p>Manage DNSSEC Keys for a chosen CDN.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="misc">
<h3>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h3>
<p>Miscellaneous editing options. Hover over this tab to get the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CDNs</p></td>
<td><p>Create/Read/Update/Delete CDNs</p></td>
</tr>
<tr class="row-odd"><td><p>Cache Groups</p></td>
<td><p>Create/Read/Update/Delete cache groups</p></td>
</tr>
<tr class="row-even"><td><p>Users</p></td>
<td><p>Create/Read/Update/Delete users</p></td>
</tr>
<tr class="row-odd"><td><p>Profiles</p></td>
<td><p>Create/Read/Update/Delete profiles. See <a class="reference internal" href="#working-with-profiles"><span class="std std-ref">Parameters and Profiles</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Networks(ASNs)</p></td>
<td><p>Create/Read/Update/Delete Autonomous System Numbers See <a class="reference internal" href="#asn-czf"><span class="std std-ref">The Coverage Zone File and ASN Table</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Hardware</p></td>
<td><p>Get detailed hardware information (note: this should be moved to a Traffic Ops Extension)</p></td>
</tr>
<tr class="row-even"><td><p>Data Types</p></td>
<td><p>Create/Read/Update/Delete data types</p></td>
</tr>
<tr class="row-odd"><td><p>Divisions</p></td>
<td><p>Create/Read/Update/Delete divisions</p></td>
</tr>
<tr class="row-even"><td><p>Regions</p></td>
<td><p>Create/Read/Update/Delete regions</p></td>
</tr>
<tr class="row-odd"><td><p>Physical Locations</p></td>
<td><p>Create/Read/Update/Delete locations</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="changelog">
<span id="index-1"></span><h3>ChangeLog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h3>
<p>The Changelog table displays the changes that are being made to the Traffic Ops database through the Traffic Ops user interface. This tab will show the number of changes since you last visited this tab in (brackets) since the last time you visited this tab. There are currently no sub menus for this tab.</p>
</div>
<div class="section" id="help">
<h3>Help<a class="headerlink" href="#help" title="Permalink to this headline">¶</a></h3>
<p>Help for Traffic Ops and Traffic Control. Hover over this tab to get the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>About</p></td>
<td><p>Traffic Ops information, such as version, database information, etc</p></td>
</tr>
<tr class="row-odd"><td><p>Release Notes</p></td>
<td><p>Release notes for the most recent releases of Traffic Ops</p></td>
</tr>
<tr class="row-even"><td><p>Logout</p></td>
<td><p>Logout from Traffic Ops</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="index-2">
<span id="id1"></span><h2>Health<a class="headerlink" href="#index-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-health-table">
<span id="health-table"></span><h3>The Health Table<a class="headerlink" href="#the-health-table" title="Permalink to this headline">¶</a></h3>
<p>The Health table is the default landing screen for Traffic Ops, it displays the status of the EDGE caches in a table form directly from Traffic Monitor (bypassing Traffic Stats), sorted by Mbps Out. The columns in this table are:</p>
<dl class="field-list simple">
<dt class="field-odd">Profile</dt>
<dd class="field-odd"><p>the Profile of this server or ALL, meaning this row shows data for multiple servers, and the row shows the sum of all values.</p>
</dd>
<dt class="field-even">Edge Cache Group</dt>
<dd class="field-even"><p>the edge cache group short name or ALL, meaning this row shows data for multiple servers, and the row shows the sum of all values.</p>
</dd>
<dt class="field-odd">Host Name</dt>
<dd class="field-odd"><p>the host name of the server or ALL, meaning this row shows data for multiple servers, and the row shows the sum of all values.</p>
</dd>
<dt class="field-even">Healthy</dt>
<dd class="field-even"><p>indicates if this cache is healthy according to the Health Protocol. A row with ALL in any of the columns will always show a <img alt="checkmark" src="../../_images/good.png" />, this column is valid only for individual EDGE caches.</p>
</dd>
<dt class="field-odd">Admin</dt>
<dd class="field-odd"><p>shows the administrative status of the server.</p>
</dd>
<dt class="field-even">Connections</dt>
<dd class="field-even"><p>the number of connections this cache (or group of caches) has open (<code class="docutils literal notranslate"><span class="pre">ats.proxy.process.http.current_client_connections</span></code> from ATS).</p>
</dd>
<dt class="field-odd">Mbps Out</dt>
<dd class="field-odd"><p>the bandwidth being served out if this cache (or group of caches)</p>
</dd>
</dl>
<p>Since the top line has ALL, ALL, ALL, it shows the total connections and bandwidth for all caches managed by this instance of Traffic Ops.</p>
</div>
<div class="section" id="graph-view">
<span id="health-graph"></span><h3>Graph View<a class="headerlink" href="#graph-view" title="Permalink to this headline">¶</a></h3>
<p>The Graph View shows a live view of the last 24 hours of bits per seconds served and open connections at the edge in a graph. This data is sourced from Traffic Stats. If there are 2 CDNs configured, this view will show the statistis for both, and the graphs are stacked. On the left-hand side, the totals and immediate values as well as the percentage of total possible capacity are displayed. This view is update every 10 seconds.</p>
</div>
<div class="section" id="server-checks">
<span id="id2"></span><h3>Server Checks<a class="headerlink" href="#server-checks" title="Permalink to this headline">¶</a></h3>
<p>The server checks page is intended to give an overview of the Servers managed by Traffic Control as well as their status. This data comes from <a class="reference external" href="traffic_ops_extensions.html">Traffic Ops extensions</a>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ILO</p></td>
<td><p>Ping the iLO interface for EDGE or MID servers</p></td>
</tr>
<tr class="row-odd"><td><p>10G</p></td>
<td><p>Ping the IPv4 address of the EDGE or MID servers</p></td>
</tr>
<tr class="row-even"><td><p>10G6</p></td>
<td><p>Ping the IPv6 address of the EDGE or MID servers</p></td>
</tr>
<tr class="row-odd"><td><p>MTU</p></td>
<td><p>Ping the EDGE or MID using the configured MTU from Traffic Ops</p></td>
</tr>
<tr class="row-even"><td><p>FQDN</p></td>
<td><p>DNS check that matches what the DNS servers responds with compared to
what Traffic Ops has.</p></td>
</tr>
<tr class="row-odd"><td><p>DSCP</p></td>
<td><p>Checks the DSCP value of packets from the edge server to the Traffic
Ops server.</p></td>
</tr>
<tr class="row-even"><td><p>RTR</p></td>
<td><p>Content Router checks. Checks the health of the Content Routers.
Checks the health of the caches using the Content Routers.</p></td>
</tr>
<tr class="row-odd"><td><p>CHR</p></td>
<td><p>Cache Hit Ratio in percent.</p></td>
</tr>
<tr class="row-even"><td><p>CDU</p></td>
<td><p>Total Cache Disk Usage in percent.</p></td>
</tr>
<tr class="row-odd"><td><p>ORT</p></td>
<td><p>Operational Readiness Test. Uses the ORT script on the edge and mid
servers to determine if the configuration in Traffic Ops matches the
configuration on the edge or mid. The user that this script runs as
must have an ssh key on the edge servers.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="daily-summary">
<h3>Daily Summary<a class="headerlink" href="#daily-summary" title="Permalink to this headline">¶</a></h3>
<p>Displays daily max gbps and bytes served for all CDNs.  In order for the graphs to appear, the ‘daily_bw_url’ and ‘daily_served_url’ parameters need to be be created, assigned to the global profile, and have a value of a grafana graph.  For more information on configuring grafana, see the <a class="reference external" href="../traffic_stats.html">Traffic Stats</a>  section.</p>
</div>
</div>
<div class="section" id="server">
<span id="id3"></span><h2>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h2>
<p>This view shows a table of all the servers in Traffic Ops. The table columns show the most important details of the server. The <strong>IPAddrr</strong> column is clickable to launch an <code class="docutils literal notranslate"><span class="pre">ssh://</span></code> link to this server. The <img alt="graph" src="../../_images/graph.png" /> icon will link to a Traffic Stats graph of this server for caches, and the <img alt="info" src="../../_images/info.png" /> will link to the server status pages for other server types.</p>
<div class="section" id="server-types">
<h3>Server Types<a class="headerlink" href="#server-types" title="Permalink to this headline">¶</a></h3>
<p>These are the types of servers that can be managed in Traffic Ops:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EDGE</p></td>
<td><p>Edge Cache</p></td>
</tr>
<tr class="row-odd"><td><p>MID</p></td>
<td><p>Mid Tier Cache</p></td>
</tr>
<tr class="row-even"><td><p>ORG</p></td>
<td><p>Origin</p></td>
</tr>
<tr class="row-odd"><td><p>CCR</p></td>
<td><p>Traffic Router</p></td>
</tr>
<tr class="row-even"><td><p>RASCAL</p></td>
<td><p>Rascal health polling &amp; reporting</p></td>
</tr>
<tr class="row-odd"><td><p>TOOLS_SERVER</p></td>
<td><p>Ops hosts for managment</p></td>
</tr>
<tr class="row-even"><td><p>RIAK</p></td>
<td><p>Riak keystore</p></td>
</tr>
<tr class="row-odd"><td><p>SPLUNK</p></td>
<td><p>SPLUNK indexer search head etc</p></td>
</tr>
<tr class="row-even"><td><p>TRAFFIC_STATS</p></td>
<td><p>traffic_stats server</p></td>
</tr>
<tr class="row-odd"><td><p>INFLUXDB</p></td>
<td><p>influxDb server</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="delivery-service">
<h2>Delivery Service<a class="headerlink" href="#delivery-service" title="Permalink to this headline">¶</a></h2>
<p>The fields in the Delivery Service view are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>Active</p></td>
<td><p>Whether or not this delivery service is active on the CDN and is capable of traffic.</p></td>
</tr>
<tr class="row-odd"><td><p>Content Routing Type</p></td>
<td><p>DNS is the standard routing type for most CDN services. HTTP Redirect is a specialty routing service that is primarily used for video and large file downloads where
localization and latency are significant concerns. A “Live” routing type should be used for all live services. See <a class="reference internal" href="#ds-types"><span class="std std-ref">Delivery Service Types</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>Key (XML ID)</p></td>
<td><p>This id becomes a part of the CDN service domain in the form <code class="docutils literal notranslate"><span class="pre">http://cdn.service-key.company.com/</span></code>. Must be all lowercase, no spaces or special characters. May
contain dashes.</p></td>
</tr>
<tr class="row-odd"><td><p>Display Name</p></td>
<td><p>Name of the service that appears in the Traffic portal. No character restrictions.</p></td>
</tr>
<tr class="row-even"><td><p>Tenant</p></td>
<td><p>Name of company or division of company who owns account. Allows you to group your services and control access. Tenants are setup as a simple hierarchy where you may
create parent / child accounts.</p></td>
</tr>
<tr class="row-odd"><td><p>CDN</p></td>
<td><p>The CDN in which the delivery service belongs to.</p></td>
</tr>
<tr class="row-even"><td><p>Routing Name</p></td>
<td><p>The routing name to use for the delivery FQDN, i.e. <code class="docutils literal notranslate"><span class="pre">&lt;routing-name&gt;.&lt;deliveryservice&gt;.&lt;cdn-domain&gt;</span></code>. It must be a valid hostname without periods. <a class="footnote-reference brackets" href="#id12" id="id4">2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Protocol</p></td>
<td><p>The protocol to serve this delivery service to the clients with:</p>
<blockquote>
<div><ul class="simple">
<li><p>HTTP: Delivery only HTTP traffic</p></li>
<li><p>HTTPS: Delivery only HTTPS traffic</p></li>
<li><p>HTTP AND HTTPS: Deliver both types of traffic.</p></li>
<li><p>HTTP TO HTTPS: Delivery HTTP traffic as HTTPS traffic</p></li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p>DSCP Tag</p></td>
<td><p>The Differentiated Services Code Point (DSCP) value to mark IP packets to the client with.</p></td>
</tr>
<tr class="row-odd"><td><p>Signing Algorithm</p></td>
<td><p>Type of URL signing method to sign the URLs:</p>
<blockquote>
<div><ul class="simple">
<li><p>null: token based auth is not enabled for this delivery service.</p></li>
<li><p>“url_sig”: URL Sign token based auth is enabled for this delivery service.</p></li>
<li><p>“uri_signing”: URI Signing token based auth is enabled for this delivery service.</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#signed-urls"><span class="std std-ref">Token Based Authentication</span></a>.</p>
</td>
</tr>
<tr class="row-even"><td><p>Deep Caching</p></td>
<td><p>Enables clients to be routed to the closest possible “deep” edge caches on a per Delivery Service basis.
See <a class="reference external" href="http://traffic-control-cdn.readthedocs.io/en/latest/admin/traffic_router.html#deep-caching-deep-coverage-zone-topology">Deep Caching</a></p></td>
</tr>
<tr class="row-odd"><td><p>Query String Handling</p></td>
<td><p>How to treat query strings:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>use in cache key and hand up to origin: Each unique query string is treated as a unique URL.</p></li>
<li><dl class="simple">
<dt>Do not use in cache key, but pass up to origin: 2 URLs that are the same except for the query string will match and cache HIT, while the origin still sees</dt><dd><p>original query string in the request.</p>
</dd>
</dl>
</li>
<li><p>Drop at edge: 2 URLs that are the same except for the query string will match and cache HIT, while the origin will not see original query string in the request.</p></li>
</ol>
</div></blockquote>
<p><strong>Note:</strong> Choosing to drop query strings at the edge will preclude the use of a Regex Remap Expression. See <a class="reference internal" href="#regex-remap"><span class="std std-ref">Regex Remap Expression</span></a>.</p>
<p>To set the qstring without the use of regex remap, or for further options, see <a class="reference internal" href="#qstring-handling"><span class="std std-ref">Qstring Handling</span></a>.</p>
</td>
</tr>
<tr class="row-even"><td><p>Geolocation Provider</p></td>
<td><p>Choose which Geolocation database provider, company that collects data on the location of IP addresses, to use.</p></td>
</tr>
<tr class="row-odd"><td><p>Anonymous Blocking</p></td>
<td><p>Set to true to enable blocking of anonymous IPs for this delivery service. <strong>Note:</strong> Requires Geolocation provider’s Anonymous IP database.</p></td>
</tr>
<tr class="row-even"><td><p>Geo Limit</p></td>
<td><p>Some services are intended to be limited by geography. The possible settings are:</p>
<blockquote>
<div><ul class="simple">
<li><p>None: Do not limit by geography.</p></li>
<li><p>CZF only: If the requesting IP is not in the Coverage Zone File, do not serve the request.</p></li>
<li><p>CZF + US: If the requesting IP is not in the Coverage Zone File or not in the United States, do not serve the request.</p></li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><p>Geo Limit Countries</p></td>
<td><p>How (if at all) is this service to be limited by geography. Example Country Codes: CA, IN, PR.</p></td>
</tr>
<tr class="row-even"><td><p>Geo Limit Redirect URL</p></td>
<td><p>Traffic Router will redirect to this URL when Geo Limit check fails. See <a class="reference internal" href="../traffic_router.html#tr-ngb"><span class="std std-ref">GeoLimit Failure Redirect Feature</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Regional Geoblocking</p></td>
<td><p>Define regional geo-blocking rules for delivery services in a JSON format and set it to True/False.
See <a class="reference external" href="http://traffic-control-cdn.readthedocs.io/en/latest/admin/quick_howto/regionalgeo.html#configure-regional-geo-blocking-rgb">regional geo-blocking</a></p></td>
</tr>
<tr class="row-even"><td><p>IPv6 Routing Enabled</p></td>
<td><p>Default is “True”, entering “False” allows you to turn off CDN response to IPv6 requests</p></td>
</tr>
<tr class="row-odd"><td><p>Range Request Handling</p></td>
<td><p>How to treat range requests:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li><p>Do not cache (ranges requested from files that are already cached due to a non range request will be a HIT)</p></li>
<li><p>Use the <a class="reference external" href="https://docs.trafficserver.apache.org/en/latest/admin-guide/plugins/background_fetch.en.html">background_fetch</a> plugin.</p></li>
<li><p>Use the cache_range_requests plugin.</p></li>
</ol>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td><p>DNS Bypass IP</p></td>
<td><p>IPv4 address to overflow requests when the Max Bps or Max Tps for this delivery service exceeds.</p></td>
</tr>
<tr class="row-odd"><td><p>DNS Bypass IPv6</p></td>
<td><p>IPv6 address to overflow requests when the Max Bps or Max Tps for this delivery service exceeds.</p></td>
</tr>
<tr class="row-even"><td><p>DNS Bypass CNAME</p></td>
<td><p>Domain name to overflow requests when the Max Bps or Max Tps for this delivery service exceeds.</p></td>
</tr>
<tr class="row-odd"><td><p>DNS Bypass TTL</p></td>
<td><p>TTL for the DNS bypass domain or IP when threshold exceeds</p></td>
</tr>
<tr class="row-even"><td><p>HTTP Bypass FQDN</p></td>
<td><p>Traffic Router will redirect to this FQDN (with the same path) when the Max Bps or Max Tps for this delivery service exceeds.</p></td>
</tr>
<tr class="row-odd"><td><p>Delivery Service DNS TTL</p></td>
<td><p>The Time To Live on the DNS record for the Traffic Router A and AAAA records. Setting too high or too low will result in poor caching performance.</p></td>
</tr>
<tr class="row-even"><td><p>Fair Queuing Pacing Rate Bps</p></td>
<td><p>The maximum bytes per second a cache will delivery on any single TCP connection. This uses the Linux kernel’s Fair Queuing setsockopt (SO_MAX_PACING_RATE) to limit
the rate of delivery. Traffic exceeding this speed will only be rate-limited and not diverted. This option requires net.core.default_qdisc = fq in /etc/sysctl.conf.</p></td>
</tr>
<tr class="row-odd"><td><p>Global Max Mbps</p></td>
<td><p>The maximum bits per second this delivery service can serve across all EDGE caches before traffic will be diverted to the bypass destination. For a DNS delivery
service, the Bypass Ipv4 or Ipv6 will be used (depending on whether this was a A or AAAA request), and for HTTP delivery services the Bypass FQDN will be used.</p></td>
</tr>
<tr class="row-even"><td><p>Global Max TPS</p></td>
<td><p>The maximum transactions per se this delivery service can serve across all EDGE caches before traffic will be diverted to the bypass destination. For a DNS delivery
service, the Bypass Ipv4 or Ipv6 will be used (depending on whether this was a A or AAAA request), and for HTTP delivery services the Bypass FQDN will be used.</p></td>
</tr>
<tr class="row-odd"><td><p>Max DNS Answers</p></td>
<td><p>It is used to restrict the number of cache IP addresses that the CCR will hand back. A numeric value from 1 to 15 which determines how many caches your content will
be spread across in a particular site. When a customer requests your content they will get 1 to 15 IP addresses back they can use. These are rotated in each response.
Ideally the number will reflect the amount of traffic. 1 = trial account with very little traffic, 2 = small production service. Add 1 more server for every 20 Gbps
of traffic you expect at peak. So 20 Gbps = 3, 40 Gbps = 4, 60 Gbps = 5</p></td>
</tr>
<tr class="row-even"><td><p>Initial Dispersion</p></td>
<td><p>Determines number of machines content will be placed on within a cache group. Setting too high will result in poor caching performance.</p></td>
</tr>
<tr class="row-odd"><td><p>Origin Server Base URL</p></td>
<td><p>The Origin Server’s base URL which includes the protocol (http or https). Example: <code class="docutils literal notranslate"><span class="pre">http://movies.origin.com</span></code>
Must be a domain only, no directories or IP addresses</p></td>
</tr>
<tr class="row-even"><td><p>Use Multi Site Origin Feature</p></td>
<td><p>Set True/False to enable/disable the Multi Site Origin feature for this delivery service. See <a class="reference internal" href="#multi-site-origin"><span class="std std-ref">Multi Site Origin</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Delivery Service Profile</p></td>
<td><p>Only used if a delivery service uses configurations that specifically require a profile. Example: MSO configurations or cachekey plugin would require a ds profile to
be used.</p></td>
</tr>
<tr class="row-even"><td><p>Geo Miss Default Latitude</p></td>
<td><p>Default Latitude for this delivery service. When client localization fails for both Coverage Zone and Geo Lookup, this the client will be routed as if it was at this
lat.</p></td>
</tr>
<tr class="row-odd"><td><p>Geo Miss Default Longitude</p></td>
<td><p>Default Longitude for this delivery service. When client localization fails for bot Coverage Zone and Geo Lookup, this the client will be routed as if it was at this
long.</p></td>
</tr>
<tr class="row-even"><td><p>Edge Header Rewrite Rules</p></td>
<td><p>Headers can be added or altered at each layer of the CDN. You must tell us four things: the action, the header name, the header value, and the direction to apply. The
action will tell us whether we are adding, removing, or replacing headers. The header name and header value will determine the full header text. The direction will
determine whether we add it before we respond to a request or before we make a request further up the chain in the server hierarchy. Examples include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Action: Set</p></li>
<li><p>Header Name: X-CDN</p></li>
<li><p>Header Value: Foo</p></li>
<li><p>Direction: Edge Response to Client</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#header-rewrite"><span class="std std-ref">Header Rewrite Options and DSCP</span></a>. <a class="footnote-reference brackets" href="#id11" id="id5">1</a></p>
</td>
</tr>
<tr class="row-odd"><td><p>Mid Header Rewrite Rules</p></td>
<td><p>Headers can be added or altered at each layer of the CDN. You must tell us four things: the action, the header name, the header value, and the direction to apply. The
action will tell us whether we are adding, removing, or replacing headers. The header name and header value will determine the full header text. The direction will
determine whether we add it before we respond to a request or before we make a request further up the chain in the server hierarchy. Examples include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Action: Set</p></li>
<li><p>Header Name: Host</p></li>
<li><p>Header Value: code_abc123</p></li>
<li><p>Direction: Mid Request to Origin</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#header-rewrite"><span class="std std-ref">Header Rewrite Options and DSCP</span></a>. <a class="footnote-reference brackets" href="#id11" id="id6">1</a></p>
</td>
</tr>
<tr class="row-even"><td><p>Traffic Router Additional Response Headers</p></td>
<td><p>List of header name:value pairs separated by __RETURN__. Listed pairs will be included in all TR HTTP responses.</p></td>
</tr>
<tr class="row-odd"><td><p>Traffic Router Log Request Headers</p></td>
<td><p>List of header keys separated by __RETURN__. Listed headers will be included in TR access log entries under the “rh=” token.</p></td>
</tr>
<tr class="row-even"><td><p>Regex remap expression</p></td>
<td><p>Allows remapping of incoming requests URL using regex pattern matching to search/replace text.
See <a class="reference external" href="https://docs.trafficserver.apache.org/en/latest/admin-guide/plugins/regex_remap.en.html">ATS documentation on regex_remap</a>. <a class="footnote-reference brackets" href="#id11" id="id7">1</a></p>
<p><strong>Note:</strong> you will not be able to save a Regex Remap Expression if you have Query String Handling set to drop query strings at the edge. See <a class="reference internal" href="#regex-remap"><span class="std std-ref">Regex Remap Expression</span></a>.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Cache URL expression</p></td>
<td><p>Deprecated.</p>
<p>Allows you to manipulate the cache key of the incoming requests. Normally, the cache key is the origin domain. This can be changed so that multiple services can share
a cache key, can also be used to preserve cached content if service origin is changed.</p>
<p><strong>Note:</strong> Only valid in ATS 6.X and earlier. Must be empty if using ATS 7.X and/or the
<a class="reference external" href="https://docs.trafficserver.apache.org/en/latest/admin-guide/plugins/cachekey.en.html">cachekey plugin</a>. <a class="footnote-reference brackets" href="#id11" id="id8">1</a></p>
<p>See <a class="reference external" href="https://docs.trafficserver.apache.org/en/6.2.x/admin-guide/plugins/cacheurl.en.html">ATS documentation on cacheurl</a>. <a class="footnote-reference brackets" href="#id11" id="id9">1</a></p>
</td>
</tr>
<tr class="row-even"><td><p>Raw remap text</p></td>
<td><p>For HTTP and DNS delivery services, this will get added to the end of the remap line on the cache verbatim. For ANY_MAP delivery services this is the remap line. <a class="footnote-reference brackets" href="#id11" id="id10">1</a></p></td>
</tr>
<tr class="row-odd"><td><p>Long Description</p></td>
<td><p>Free text field that describes the purpose of the delivery service and will be displayed in the portal as a description field. For example, you can use this field to
describe your service.</p></td>
</tr>
<tr class="row-even"><td><p>Long Description 2</p></td>
<td><p>Free text field not currently used in configuration. For example, you can use this field to describe your customer type.</p></td>
</tr>
<tr class="row-odd"><td><p>Long Description 3</p></td>
<td><p>Free text field not currently used in configuration.</p></td>
</tr>
<tr class="row-even"><td><p>Info URL</p></td>
<td><p>Free text field allowing you to enter a URL which provides information about the service.</p></td>
</tr>
<tr class="row-odd"><td><p>Check Path</p></td>
<td><p>A path (ex: /crossdomain.xml) to verify the connection to the origin server with. This can be used by Check Extension scripts to do periodic health checks against the
delivery service.</p></td>
</tr>
<tr class="row-even"><td><p>Origin Shield (Pipe Delimited String)</p></td>
<td><p>Add another forward proxy upstream of the mid caches. Example: go_direct=true will allow the Mid to hit the origin directly instead of failing if the origin shield is
down. Experimental Feature.</p></td>
</tr>
<tr class="row-odd"><td><p>Logs Enabled</p></td>
<td><p>Allows you to turn on/off logging for the service</p></td>
</tr>
</tbody>
</table>
<dl class="footnote brackets">
<dt class="label" id="id11"><span class="brackets">1</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>,<a href="#id7">3</a>,<a href="#id8">4</a>,<a href="#id9">5</a>,<a href="#id10">6</a>)</span></dt>
<dd><p>These fields are not validated by Traffic Ops to be correct syntactically, and can cause Traffic Server to not start if invalid. Please use with caution.</p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>It is not recommended to change the Routing Name of a Delivery Service after deployment because this changes its Delivery FQDN (i.e. <code class="docutils literal notranslate"><span class="pre">&lt;routing-name&gt;.&lt;deliveryservice&gt;.&lt;cdn-domain&gt;</span></code>), which means that SSL certificates may need to be updated and clients using the Delivery Service will need to be transitioned to the new Delivery URL.</p>
</dd>
</dl>
<div class="section" id="delivery-service-types">
<span id="ds-types"></span><span id="index-3"></span><h3>Delivery Service Types<a class="headerlink" href="#delivery-service-types" title="Permalink to this headline">¶</a></h3>
<p>One of the most important settings when creating the delivery service is the selection of the delivery service <em>type</em>. This type determines the routing method and the primary storage for the delivery service.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>HTTP</p></td>
<td><p>HTTP Content Routing  - The Traffic Router DNS auth server returns its own IP address on DNS queries, and the client gets redirected to a specific cache
in the nearest cache group using HTTP 302.  Use this for long sessions like HLS/HDS/Smooth live streaming, where a longer setup time is not a problem.</p></td>
</tr>
<tr class="row-odd"><td><p>DNS</p></td>
<td><p>DNS Content Routing - The Traffic Router DNS auth server returns an edge cache IP address to the client right away. The client will find the cache quickly
but the Traffic Router can not route to a cache that already has this content in the cache group. Use this for smaller objects like web page images / objects.</p></td>
</tr>
<tr class="row-even"><td><p>HTTP_NO_CACHE</p></td>
<td><p>HTTP Content Routing, but the caches will not actually cache the content, they act as just proxies. The MID tier is bypassed.</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP_LIVE</p></td>
<td><p>HTTP Content routing, but where for “standard” HTTP content routing the objects are stored on disk, for this delivery service type the objects are stored
on the RAM disks. Use this for linear TV. The MID tier is bypassed for this type.</p></td>
</tr>
<tr class="row-even"><td><p>HTTP_LIVE_NATNL</p></td>
<td><p>HTTP Content routing, same as HTTP_LIVE, but the MID tier is NOT bypassed.</p></td>
</tr>
<tr class="row-odd"><td><p>DNS_LIVE_NATNL</p></td>
<td><p>DNS Content routing, but where for “standard” DNS content routing the objects are stored on disk, for this delivery service type the objects are stored
on the RAM disks. Use this for linear TV. The MID tier is NOT bypassed for this type.</p></td>
</tr>
<tr class="row-even"><td><p>DNS_LIVE</p></td>
<td><p>DNS Content routing, same as DNS_LIVE_NATNL, but the MID tier is bypassed.</p></td>
</tr>
<tr class="row-odd"><td><p>ANY_MAP</p></td>
<td><p>ANY_MAP is not known to Traffic Router. For this deliveryservice, the “Raw remap text” field in the input form will be used as the remap line on the cache.</p></td>
</tr>
<tr class="row-even"><td><p>STEERING</p></td>
<td><p>The Delivery Service will be used to route to other delivery services. The target delivery services and the routing weights for those delivery services will be defined by an admin or steering
user. For more information see the <a class="reference external" href="../traffic_router.html#steering-feature">steering feature</a> documentation</p></td>
</tr>
<tr class="row-odd"><td><p>CLIENT_STEERING</p></td>
<td><p>Similar to STEERING except that a client can send a request to Traffic Router with a query param of <cite>trred=false</cite>, and Traffic Router will return an HTTP 200 response with a body that contains
a list of Delivery Service URLs that the client can connect to.  Therefore, the client is doing the steering, not the Traffic Router.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="federations">
<span id="id13"></span><h3>Federations<a class="headerlink" href="#federations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Federations allow for other (federated) CDNs (at a different ISP, MSO, etc) to add a list of resolvers and a CNAME to a delivery service Traffic Ops.  When a request is made from one of federated CDN’s clients, Traffic Router will return the CNAME configured in the federation mapping.  This allows the federated CDN to serve the content without the content provider changing the URL, or having to manage multiple URLs.</p>
<p>Before adding a federation in the Traffic Ops UI, a user with the federations role needs to be created.  This user will be assigned to the federation and will be able to add resolvers to the federation via the Traffic Ops <a class="reference external" href="../../development/traffic_ops_api/v12/federation.html">Federation API</a>.</p>
</div></blockquote>
</div>
<div class="section" id="header-rewrite-options-and-dscp">
<span id="header-rewrite"></span><span id="index-4"></span><h3>Header Rewrite Options and DSCP<a class="headerlink" href="#header-rewrite-options-and-dscp" title="Permalink to this headline">¶</a></h3>
<p>Most header manipulation and per-delivery service configuration overrides are done using the <a class="reference external" href="https://docs.trafficserver.apache.org/en/latest/admin-guide/plugins/header_rewrite.en.html">ATS Header Rewrite Plugin</a>. Traffic Control allows you to enter header rewrite rules to be applied at the edge and at the mid level. The syntax used in Traffic Ops is the same as the one described in the ATS documentation, except for some special strings that will get replaced:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Traffic Ops Entry</p></th>
<th class="head"><p>Gets Replaced with</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__RETURN__</p></td>
<td><p>A newline</p></td>
</tr>
<tr class="row-odd"><td><p>__CACHE_IPV4__</p></td>
<td><p>The cache’s IPv4 address</p></td>
</tr>
</tbody>
</table>
<p>The deliveryservice screen also allows you to set the DSCP value of traffic sent to the client. This setting also results in a header_rewrite rule to be generated and applied to at the edge.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The DSCP setting in the UI is <em>only</em> for setting traffic towards the client, and gets applied <em>after</em> the initial TCP handshake is complete, and the HTTP request is received (before that the cache can’t determine what deliveryservice this request is for, and what DSCP to apply), so the DSCP feature can not be used for security settings - the TCP SYN-ACK is not going to be DSCP marked.</p>
</div>
</div>
<div class="section" id="token-based-authentication">
<span id="signed-urls"></span><span id="index-5"></span><h3>Token Based Authentication<a class="headerlink" href="#token-based-authentication" title="Permalink to this headline">¶</a></h3>
<p>Token based authentication or <em>signed URLs</em> is implemented using the Traffic Server <code class="docutils literal notranslate"><span class="pre">url_sig</span></code> plugin. To sign a URL at the signing portal take the full URL, without any query string, and add on a query string with the following parameters:</p>
<dl>
<dt>Client IP address</dt><dd><p>The client IP address that this signature is valid for. e.g. <code class="docutils literal notranslate"><span class="pre">C=&lt;client</span> <span class="pre">IP</span> <span class="pre">address&gt;</span></code></p>
</dd>
<dt>Expiration</dt><dd><p>The Expiration time (seconds since epoch) of this signature. e.g. <code class="docutils literal notranslate"><span class="pre">E=&lt;expiration</span> <span class="pre">time</span> <span class="pre">in</span> <span class="pre">secs</span> <span class="pre">since</span> <span class="pre">unix</span> <span class="pre">epoch&gt;</span></code></p>
</dd>
<dt>Algorithm</dt><dd><p>The Algorithm used to create the signature. Only 1 (HMAC_SHA1) and 2 (HMAC_MD5) are supported at this time e.g. <code class="docutils literal notranslate"><span class="pre">A=&lt;algorithm</span> <span class="pre">number&gt;</span></code></p>
</dd>
<dt>Key index</dt><dd><p>Index of the key used. This is the index of the key in the configuration file on the cache. The set of keys is a shared secret between the signing portal and the edge caches. There is one set of keys per reverse proxy domain (fqdn). e.g. <code class="docutils literal notranslate"><span class="pre">K=&lt;key</span> <span class="pre">index</span> <span class="pre">used&gt;</span></code></p>
</dd>
<dt>Parts</dt><dd><p>Parts to use for the signature, always excluding the scheme (<a class="reference external" href="http://">http://</a>).  parts0 = fqdn, parts1..x is the directory parts of the path, if there are more parts to the path than letters in the parts param, the last one is repeated for those. Format: <code class="docutils literal notranslate"><span class="pre">P=&lt;parts</span> <span class="pre">string</span> <span class="pre">(0's</span> <span class="pre">and</span> <span class="pre">1's)&gt;</span></code> Examples:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">1</dt>
<dd class="field-odd"><p>use fqdn and all of URl path</p>
</dd>
<dt class="field-even">0110</dt>
<dd class="field-even"><p>use part1 and part 2 of path only</p>
</dd>
<dt class="field-odd">01</dt>
<dd class="field-odd"><p>use everything except the fqdn</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>Signature</dt><dd><p>The signature over the parts + the query string up to and including “S=”. e.g. <code class="docutils literal notranslate"><span class="pre">S=&lt;signature&gt;</span></code></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The url_sig <a class="reference external" href="https://github.com/apache/trafficserver/blob/master/plugins/experimental/url_sig/README">README</a>.</p>
</div>
<div class="section" id="generate-url-sig-keys">
<h4>Generate URL Sig Keys<a class="headerlink" href="#generate-url-sig-keys" title="Permalink to this headline">¶</a></h4>
<p>To generate a set of random signed url keys for this delivery service and store them in Traffic Vault, click the <strong>Generate URL Sig Keys</strong> button at the bottom of the delivery service details screen.</p>
</div>
</div>
<div class="section" id="parent-selection">
<h3>Parent Selection<a class="headerlink" href="#parent-selection" title="Permalink to this headline">¶</a></h3>
<p>Parameters in the Edge (child) profile that influence this feature:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.parent_proxy_routing_enable</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td><p>enable parent selection.  This is a required setting.</p></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
url_remap.remap_required</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td><p>required for parent selection.</p></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.no_dns_just_forward_to_parent</p></td>
<td><p>records.config</p></td>
<td><p>INT 0</p></td>
<td><p>See</p></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.uncacheable_requests_bypass_parent</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.parent_proxy_routing_enable</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.parent_proxy.retry_time</p></td>
<td><p>records.config</p></td>
<td><p>INT 300</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.parent_proxy.fail_threshold</p></td>
<td><p>records.config</p></td>
<td><p>INT 10</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.parent_proxy.total_connect_attempts</p></td>
<td><p>records.config</p></td>
<td><p>INT 4</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.parent_proxy.per_parent_connect_attempts</p></td>
<td><p>records.config</p></td>
<td><p>INT 2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.parent_proxy.connect_attempts_timeout</p></td>
<td><p>records.config</p></td>
<td><p>INT 30</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.forward.proxy_auth_to_parent</p></td>
<td><p>records.config</p></td>
<td><p>INT 0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.parent_proxy_routing_enable</p></td>
<td><p>records.config</p></td>
<td><p>INT 0</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CONFIG proxy.config.
http.parent_proxy.file</p></td>
<td><p>records.config</p></td>
<td><p>STRING
parent.config</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config.
http.parent_proxy.connect_attempts_timeout</p></td>
<td><p>records.config</p></td>
<td><p>INT 3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>algorithm</p></td>
<td><p>parent.config</p></td>
<td><p>urlhash</p></td>
<td><p>The algorithm to use.</p></td>
</tr>
</tbody>
</table>
<p>Parameters in the Mid (parent) profile that influence this feature:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>domain_name</p></td>
<td><p>CRConfig.json</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Only parents with the same value as the edge are going to be used as parents (to keep separation between CDNs)</p></td>
</tr>
<tr class="row-odd"><td><p>weight</p></td>
<td><p>parent.config</p></td>
<td><p>1.0</p></td>
<td><p>The weight of this parent, translates to the number of replicas in the consistent hash ring. This parameter only has effect with algorithm at the client set to
“consistent_hash”</p></td>
</tr>
<tr class="row-even"><td><p>port</p></td>
<td><p>parent.config</p></td>
<td><p>80</p></td>
<td><p>The port this parent is listening on as a forward proxy.</p></td>
</tr>
<tr class="row-odd"><td><p>use_ip_address</p></td>
<td><p>parent.config</p></td>
<td><p>0</p></td>
<td><p>1 means use IP(v4) address of this parent in the parent.config, 0 means use the host_name.domain_name concatenation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="qstring-handling">
<span id="id14"></span><h3>Qstring Handling<a class="headerlink" href="#qstring-handling" title="Permalink to this headline">¶</a></h3>
<p>Delivery services have a Query String Handling option that, when set to ignore, will automatically add a regex remap to that delivery service’s config.  There may be times this is not preferred, or there may be requirements for one delivery service or server(s) to behave differently.  When this is required, the psel.qstring_handling parameter can be set in either the delivery service profile or the server profile, but it is important to note that the server profile will override ALL delivery services assigned to servers with this profile parameter.  If the parameter is not set for the server profile but is present for the Delivery Service profile, this will override the setting in the delivery service.  A value of “ignore” will not result in the addition of regex remap configuration.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>psel.qstring_handling</p></td>
<td><p>parent.config</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Sets qstring handling without the use of regex remap for a delivery service when assigned to a delivery service profile, and overrides qstring handling for all
Delivery Services for associated servers when assigned to a server profile. Value must be “consider” or “ignore”.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multi-site-origin">
<span id="id15"></span><h3>Multi Site Origin<a class="headerlink" href="#multi-site-origin" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration of this feature changed significantly between ATS version 5 and &gt;= 6. Some configuration in Traffic Control is different as well. This documentation assumes ATS 6 or higher. See <a class="reference internal" href="../quick_howto/multi_site.html#multi-site-origin-qht"><span class="std std-ref">Configure Multi-Site Origin</span></a> for more details.</p>
</div>
<p>Normally, the mid servers are not aware of any redundancy at the origin layer. With Multi Site Origin enabled this changes - Traffic Server (and Traffic Ops) are now made aware of the fact there are multiple origins, and can be configured to do more advanced failover and loadbalancing actions. A prerequisite for MSO to work is that the multiple origin sites serve identical content with identical paths, and both are configured to serve the same origin hostname as is configured in the deliveryservice <cite>Origin Server Base URL</cite> field. See the <a class="reference external" href="https://docs.trafficserver.apache.org/en/latest/admin-guide/files/parent.config.en.html">Apache Traffic Server docs</a> for more information on that cache’s implementation.</p>
<p>With This feature enabled, origin servers (or origin server VIP names for a site) are going to be entered as servers in to the Traiffic Ops UI. Server type is “ORG”.</p>
<p>Parameters in the mid profile that influence this feature:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 8%" />
<col style="width: 6%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CONFIG proxy.config. http.parent_proxy_routing_enable</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td><p>enable parent selection.  This is a required setting.</p></td>
</tr>
<tr class="row-odd"><td><p>CONFIG proxy.config. url_remap.remap_required</p></td>
<td><p>records.config</p></td>
<td><p>INT 1</p></td>
<td><p>required for parent selection.</p></td>
</tr>
</tbody>
</table>
<p>Parameters in the deliveryservice profile that influence this feature:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mso.parent_retry</p></td>
<td><p>parent.config</p></td>
<td><p>-</p></td>
<td><p>Either <code class="docutils literal notranslate"><span class="pre">simple_retry</span></code>, <code class="docutils literal notranslate"><span class="pre">dead_server_retry</span></code> or <code class="docutils literal notranslate"><span class="pre">both</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>mso.algorithm</p></td>
<td><p>parent.config</p></td>
<td><p>consistent_hash</p></td>
<td><p>The algorithm to use. <code class="docutils literal notranslate"><span class="pre">consisten_hash</span></code>, <code class="docutils literal notranslate"><span class="pre">strict</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>, or <code class="docutils literal notranslate"><span class="pre">latched</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">consisten_hash</span></code> - spreads requests across multiple parents simultaneously based on hash of content URL.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strict</span></code> - strict Round Robin spreads requests across multiple parents simultaneously based on order of requests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> - same as strict, but ensures that requests from the same IP always go to the same parent if available.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> - uses only a single parent at any given time and switches to a new parent only if the current parent fails.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latched</span></code> - same as false, but now, a failed parent will not be retried.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>mso.unavailable_server_retry_response_codes</p></td>
<td><p>parent.config</p></td>
<td><p>“503”</p></td>
<td><p>Quoted, comma separated list of HTTP status codes that count as a unavailable_server_retry_response_code.</p></td>
</tr>
<tr class="row-odd"><td><p>mso.max_unavailable_server_retries</p></td>
<td><p>parent.config</p></td>
<td><p>1</p></td>
<td><p>How many times an unavailable server will be retried.</p></td>
</tr>
<tr class="row-even"><td><p>mso.simple_retry_response_codes</p></td>
<td><p>parent.config</p></td>
<td><p>“404”</p></td>
<td><p>Quoted, comma separated list of HTTP status codes that count as a simple retry response code.</p></td>
</tr>
<tr class="row-odd"><td><p>mso.max_simple_retries</p></td>
<td><p>parent.config</p></td>
<td><p>1</p></td>
<td><p>How many times a simple retry will be done.</p></td>
</tr>
</tbody>
</table>
<p>see <a class="reference internal" href="../quick_howto/multi_site.html#multi-site-origin-qht"><span class="std std-ref">Configure Multi-Site Origin</span></a> for a <em>quick how to</em> on this feature.</p>
</div>
<div class="section" id="traffic-router-profile">
<span id="ccr-profile"></span><h3>Traffic Router Profile<a class="headerlink" href="#traffic-router-profile" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 11%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Config_file</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>location</p></td>
<td><p>dns.zone</p></td>
<td><p>Location to store the DNS zone files in the local file system of Traffic Router.</p></td>
</tr>
<tr class="row-odd"><td><p>location</p></td>
<td><p>http-log4j.properties</p></td>
<td><p>Location to find the log4j.properties file for Traffic Router.</p></td>
</tr>
<tr class="row-even"><td><p>location</p></td>
<td><p>dns-log4j.properties</p></td>
<td><p>Location to find the dns-log4j.properties file for Traffic Router.</p></td>
</tr>
<tr class="row-odd"><td><p>location</p></td>
<td><p>geolocation.properties</p></td>
<td><p>Location to find the log4j.properties file for Traffic Router.</p></td>
</tr>
<tr class="row-even"><td><p>CDN_name</p></td>
<td><p>rascal-config.txt</p></td>
<td><p>The human readable name of the CDN for this profile.</p></td>
</tr>
<tr class="row-odd"><td><p>CoverageZoneJsonURL</p></td>
<td><p>CRConfig.xml</p></td>
<td><p>The location (URL) to retrieve the coverage zone map file in JSON format from.</p></td>
</tr>
<tr class="row-even"><td><p>ecsEnable</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Boolean value to enable or disable ENDS0 client subnet extensions.</p></td>
</tr>
<tr class="row-odd"><td><p>geolocation.polling.url</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The location (URL) to retrieve the geo database file from.</p></td>
</tr>
<tr class="row-even"><td><p>geolocation.polling.interval</p></td>
<td><p>CRConfig.json</p></td>
<td><p>How often to refresh the coverage geo location database  in ms</p></td>
</tr>
<tr class="row-odd"><td><p>coveragezone.polling.interval</p></td>
<td><p>CRConfig.json</p></td>
<td><p>How often to refresh the coverage zone map in ms</p></td>
</tr>
<tr class="row-even"><td><p>coveragezone.polling.url</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The location (URL) to retrieve the coverage zone map file in JSON format from.</p></td>
</tr>
<tr class="row-odd"><td><p>deepcoveragezone.polling.interval</p></td>
<td><p>CRConfig.json</p></td>
<td><p>How often to refresh the deep coverage zone map in ms</p></td>
</tr>
<tr class="row-even"><td><p>deepcoveragezone.polling.url</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The location (URL) to retrieve the deep coverage zone map file in JSON format from.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.soa.expire</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The value for the expire field the Traffic Router DNS Server will respond with on Start of Authority (SOA) records.</p></td>
</tr>
<tr class="row-even"><td><p>tld.soa.minimum</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The value for the minimum field the Traffic Router DNS Server will respond with on SOA records.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.soa.admin</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The DNS Start of Authority admin.  Should be a valid support email address for support if DNS is not working correctly.</p></td>
</tr>
<tr class="row-even"><td><p>tld.soa.retry</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The value for the retry field the Traffic Router DNS Server will respond with on SOA records.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.soa.refresh</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on A records.</p></td>
</tr>
<tr class="row-even"><td><p>tld.ttls.NS</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on NS records.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.ttls.SOA</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on SOA records.</p></td>
</tr>
<tr class="row-even"><td><p>tld.ttls.AAAA</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The Time To Live (TTL) the Traffic Router DNS Server will respond with on AAAA records.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.ttls.A</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on A records.</p></td>
</tr>
<tr class="row-even"><td><p>tld.ttls.DNSKEY</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on DNSKEY records.</p></td>
</tr>
<tr class="row-odd"><td><p>tld.ttls.DS</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The TTL the Traffic Router DNS Server will respond with on DS records.</p></td>
</tr>
<tr class="row-even"><td><p>api.port</p></td>
<td><p>server.xml</p></td>
<td><p>The TCP port Traffic Router listens on for API (REST) access.</p></td>
</tr>
<tr class="row-odd"><td><p>api.cache-control.max-age</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The value of the <code class="docutils literal notranslate"><span class="pre">Cache-Control:</span> <span class="pre">max-age=</span></code> header in the API responses of Traffic Router.</p></td>
</tr>
<tr class="row-even"><td><p>api.auth.url</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The API authentication URL (<a class="reference external" href="https:/">https:/</a>/${tmHostname}/api/1.1/user/login); ${tmHostname} is a search and replace token used by Traffic Router to
construct the correct URL)</p></td>
</tr>
<tr class="row-odd"><td><p>consistent.dns.routing</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Control whether DNS Delivery Services use consistent hashing on the edge FQDN to select caches for answers. May improve performance if set to
true; defaults to false</p></td>
</tr>
<tr class="row-even"><td><p>dnssec.enabled</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Whether DNSSEC is enabled; this parameter is updated via the DNSSEC administration user interface.</p></td>
</tr>
<tr class="row-odd"><td><p>dnssec.allow.expired.keys</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Allow Traffic Router to use expired DNSSEC keys to sign zones; default is true. This helps prevent DNSSEC related outages due to failed Traffic
Control components or connectivity issues.</p></td>
</tr>
<tr class="row-even"><td><p>dynamic.cache.primer.enabled</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Allow Traffic Router to attempt to prime the dynamic zone cache; defaults to true</p></td>
</tr>
<tr class="row-odd"><td><p>dynamic.cache.primer.limit</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Limit the number of permutations to prime when dynamic zone cache priming is enabled; defaults to 500</p></td>
</tr>
<tr class="row-even"><td><p>keystore.maintenance.interval</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The interval in seconds which Traffic Router will check the keystore API for new DNSSEC keys</p></td>
</tr>
<tr class="row-odd"><td><p>keystore.api.url</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The keystore API URL (<a class="reference external" href="https:/">https:/</a>/${tmHostname}/api/1.1/cdns/name/${cdnName}/dnsseckeys.json; ${tmHostname} and ${cdnName} are search and replace
tokens used by Traffic Router to construct the correct URL)</p></td>
</tr>
<tr class="row-even"><td><p>keystore.fetch.timeout</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The timeout in milliseconds for requests to the keystore API</p></td>
</tr>
<tr class="row-odd"><td><p>keystore.fetch.retries</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The number of times Traffic Router will attempt to load keys before giving up; defaults to 5</p></td>
</tr>
<tr class="row-even"><td><p>keystore.fetch.wait</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The number of milliseconds Traffic Router will wait before a retry</p></td>
</tr>
<tr class="row-odd"><td><p>signaturemanager.expiration.multiplier</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Multiplier used in conjunction with a zone’s maximum TTL to calculate DNSSEC signature durations; defaults to 5</p></td>
</tr>
<tr class="row-even"><td><p>zonemanager.threadpool.scale</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Multiplier used to determine the number of cores to use for zone signing operations; defaults to 0.75</p></td>
</tr>
<tr class="row-odd"><td><p>zonemanager.cache.maintenance.interval</p></td>
<td><p>CRConfig.json</p></td>
<td><p>The interval in seconds which Traffic Router will check for zones that need to be resigned or if dynamic zones need to be expired from cache</p></td>
</tr>
<tr class="row-even"><td><p>zonemanager.dynamic.response.expiration</p></td>
<td><p>CRConfig.json</p></td>
<td><p>A string (e.g.: 300s) that defines how long a dynamic zone</p></td>
</tr>
<tr class="row-odd"><td><p>DNSKEY.generation.multiplier</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Used to deteremine when new keys need to be regenerated. Keys are regenerated if expiration is less than the generation multiplier * the TTL. If
the parameter does not exist, the default is 10.</p></td>
</tr>
<tr class="row-even"><td><p>DNSKEY.effective.multiplier</p></td>
<td><p>CRConfig.json</p></td>
<td><p>Used when creating an effective date for a new key set.  New keys are generated with an effective date of old key expiration - (effective
multiplier * TTL).  Default is 2.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="regex-remap-expression">
<span id="regex-remap"></span><span id="index-6"></span><h3>Regex Remap Expression<a class="headerlink" href="#regex-remap-expression" title="Permalink to this headline">¶</a></h3>
<p>The regex remap expression allows to to use a regex and resulting match group(s) in order to modify the request URIs that are sent to origin. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>^/original/(.*) http://origin.example.com/remapped/$1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <strong>Query String Handling</strong> is set to <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">Drop</span> <span class="pre">at</span> <span class="pre">edge</span></code>, then you will not be allowed to save a regex remap expression, as dropping query strings actually relies on a regex remap of its own. However, if there is a need to both drop query strings <strong>and</strong> remap request URIs, this can be accomplished by setting <strong>Query String Handling</strong> to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">Do</span> <span class="pre">not</span> <span class="pre">use</span> <span class="pre">in</span> <span class="pre">cache</span> <span class="pre">key,</span> <span class="pre">but</span> <span class="pre">pass</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">origin</span></code>, and then using a custom regex remap expression to do the necessary remapping, while simultaneously dropping query strings. The following example will capture the original request URI up to, but not including, the query string and then forward to a remapped URI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>^/([^?]*).* http://origin.example.com/remapped/$1
</pre></div>
</div>
</div>
</div>
<div class="section" id="delivery-service-regexp">
<span id="ds-regexp"></span><span id="index-7"></span><h3>Delivery Service Regexp<a class="headerlink" href="#delivery-service-regexp" title="Permalink to this headline">¶</a></h3>
<p>This table defines how requests are matched to the delivery service. There are 3 type of entries possible here:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 64%" />
<col style="width: 13%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>DS Type</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>HOST_REGEXP</p></td>
<td><p>This is the regular expresion to match the host part of the URL.</p></td>
<td><p>DNS and HTTP</p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p>PATH_REGEXP</p></td>
<td><p>This is the regular expresion to match the path part of the URL.</p></td>
<td><p>HTTP</p></td>
<td><p>Beta</p></td>
</tr>
<tr class="row-even"><td><p>HEADER_REGEXP</p></td>
<td><p>This is the regular expresion to match on any header in the request.</p></td>
<td><p>HTTP</p></td>
<td><p>Beta</p></td>
</tr>
</tbody>
</table>
<p>The <strong>Order</strong> entry defines the order in which the regular expressions get evaluated. To support <code class="docutils literal notranslate"><span class="pre">CNAMES</span></code> from domains outside of the Traffic Control top level DNS domain, enter multiple <code class="docutils literal notranslate"><span class="pre">HOST_REGEXP</span></code> lines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases is is sufficient to have just one entry in this table that has a <code class="docutils literal notranslate"><span class="pre">HOST_REGEXP</span></code> Type, and Order <code class="docutils literal notranslate"><span class="pre">0</span></code>. For the <em>movies</em> delivery service in the Kabletown CDN, the entry is simply single <code class="docutils literal notranslate"><span class="pre">HOST_REGEXP</span></code> set to <code class="docutils literal notranslate"><span class="pre">.*\.movies\..*</span></code>. This will match every url that has a hostname that ends with <code class="docutils literal notranslate"><span class="pre">movies.cdn1.kabletown.net</span></code>, since <code class="docutils literal notranslate"><span class="pre">cdn1.kabletown.net</span></code> is the Kabletown CDN’s DNS domain.</p>
</div>
</div>
<div class="section" id="static-dns-entries">
<span id="static-dns"></span><span id="index-8"></span><h3>Static DNS Entries<a class="headerlink" href="#static-dns-entries" title="Permalink to this headline">¶</a></h3>
<p>Static DNS entries allow you to create other names <em>under</em> the delivery service domain. You can enter any valid hostname, and create a CNAME, A or AAAA record for it by clicking the <strong>Static DNS</strong> button at the bottom of the delivery service details screen.</p>
</div>
<div class="section" id="server-assignments">
<span id="assign-edges"></span><span id="index-9"></span><h3>Server Assignments<a class="headerlink" href="#server-assignments" title="Permalink to this headline">¶</a></h3>
<p>Click the <strong>Server Assignments</strong> button at the bottom of the screen to assign servers to this delivery service.  Servers can be selected by drilling down in a tree, starting at the profile, then the cache group, and then the individual servers. Traffic Router will only route traffic for this delivery service to servers that are assigned to it.</p>
</div>
<div class="section" id="the-coverage-zone-file-and-asn-table">
<span id="asn-czf"></span><h3>The Coverage Zone File and ASN Table<a class="headerlink" href="#the-coverage-zone-file-and-asn-table" title="Permalink to this headline">¶</a></h3>
<p>The Coverage Zone File (CZF) should contain a cachegroup name to network prefix mapping in the form:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="nt">&quot;coverageZones&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;cache-group-01&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;latitude&quot;</span><span class="p">:</span>  <span class="mf">1.1</span><span class="p">,</span>
                                <span class="nt">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">2.2</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;network6&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;1234:5678::/64&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;1234:5679::/64&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;192.168.8.0/24&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;192.168.9.0/24&quot;</span>
                        <span class="p">]</span>
                <span class="p">},</span>
                <span class="nt">&quot;cache-group-02&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;latitude&quot;</span><span class="p">:</span>  <span class="mf">3.3</span><span class="p">,</span>
                                <span class="nt">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">4.4</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;network6&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;1234:567a::/64&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;1234:567b::/64&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;192.168.4.0/24&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;192.168.5.0/24&quot;</span>
                        <span class="p">]</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The CZF is an input to the Traffic Control CDN, and as such does not get generated by Traffic Ops, but rather, it gets consumed by Traffic Router. Some popular IP management systems output a very similar file to the CZF but in stead of a cachegroup an ASN will be listed. Traffic Ops has the “Networks (ASNs)” view to aid with the conversion of files like that to a Traffic Control CZF file; this table is not used anywhere in Traffic Ops, but can be used to script the conversion using the API.</p>
<p>The script that generates the CZF file is not part of Traffic Control, since it is different for each situation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;coordinates&quot;</span></code> section is optional and may be used by Traffic Router for localization in the case of a CZF “hit” where the zone name does not map to a Cache Group name in Traffic Ops (i.e. Traffic Router will route to the closest Cache Group(s) geographically).</p>
</div>
</div>
<div class="section" id="the-deep-coverage-zone-file">
<span id="deep-czf"></span><h3>The Deep Coverage Zone File<a class="headerlink" href="#the-deep-coverage-zone-file" title="Permalink to this headline">¶</a></h3>
<p>The Deep Coverage Zone File (DCZF) format is similar to the CZF format but adds a <code class="docutils literal notranslate"><span class="pre">caches</span></code> list under each <code class="docutils literal notranslate"><span class="pre">deepCoverageZone</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="nt">&quot;deepCoverageZones&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;location-01&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;latitude&quot;</span><span class="p">:</span>  <span class="mf">5.5</span><span class="p">,</span>
                                <span class="nt">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">6.6</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;network6&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;1234:5678::/64&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;1234:5679::/64&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;192.168.8.0/24&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;192.168.9.0/24&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;caches&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;edge-01&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;edge-02&quot;</span>
                        <span class="p">]</span>
                <span class="p">},</span>
                <span class="nt">&quot;location-02&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;latitude&quot;</span><span class="p">:</span>  <span class="mf">7.7</span><span class="p">,</span>
                                <span class="nt">&quot;longitude&quot;</span><span class="p">:</span> <span class="mf">8.8</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;network6&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;1234:567a::/64&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;1234:567b::/64&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;192.168.4.0/24&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;192.168.5.0/24&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;caches&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;edge-02&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;edge-03&quot;</span>
                        <span class="p">]</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each entry in the <code class="docutils literal notranslate"><span class="pre">caches</span></code> list is the hostname of an edge cache registered in Traffic Ops which will be used for “deep” caching in that Deep Coverage Zone. Unlike a regular CZF, coverage zones in the DCZF do not map to a Cache Group in Traffic Ops, so currently the deep coverage zone name only needs to be unique.</p>
<p>If the Traffic Router gets a DCZF “hit” for a requested Delivery Service that has Deep Caching enabled, the client will be routed to an available “deep” cache from that zone’s <code class="docutils literal notranslate"><span class="pre">caches</span></code> list.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;coordinates&quot;</span></code> section is optional.</p>
</div>
</div>
</div>
<div class="section" id="parameters-and-profiles">
<span id="working-with-profiles"></span><h2>Parameters and Profiles<a class="headerlink" href="#parameters-and-profiles" title="Permalink to this headline">¶</a></h2>
<p>Parameters are shared between profiles if the set of <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">name,</span> <span class="pre">config_file,</span> <span class="pre">value</span> <span class="pre">}</span></code> is the same. To change a value in one profile but not in others, the parameter has to be removed from the profile you want to change it in, and a new parameter entry has to be created (<strong>Add Parameter</strong> button at the bottom of the Parameters view), and assigned to that profile. It is easy to create new profiles from the <strong>Misc &gt; Profiles</strong> view - just use the <strong>Add/Copy Profile</strong> button at the bottom of the profile view to copy an existing profile to a new one. Profiles can be exported from one system and imported to another using the profile view as well. It makes no sense for a parameter to not be assigned to a single profile - in that case it really has no function. To find parameters like that use the <strong>Parameters &gt; Orphaned Parameters</strong> view. It is easy to create orphaned parameters by removing all profiles, or not assigning a profile directly after creating the parameter.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="configuration.html#param-prof"><span class="std std-ref">Profile Parameters</span></a> in the <em>Configuring Traffic Ops</em> section.</p>
</div>
</div>
<div class="section" id="id16">
<h2>Tools<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generate-iso">
<span id="index-10"></span><span id="id17"></span><h3>Generate ISO<a class="headerlink" href="#generate-iso" title="Permalink to this headline">¶</a></h3>
<p>Generate ISO is a tool for building custom ISOs for building caches on remote hosts. Currently it only supports Centos 6, but if you’re brave and pure of heart you MIGHT be able to get it to work with other unix-like OS’s.</p>
<p>The interface is <em>mostly</em> self-explanatory as it’s got hints.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Explaination</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Choose a server from list:</p></td>
<td><p>This option gets all the server names currently in the Traffic Ops database and will autofill known values.</p></td>
</tr>
<tr class="row-odd"><td><p>OS Version:</p></td>
<td><p>There needs to be an _osversions.cfg_ file in the ISO directory that maps the name of a directory to a name that shows up here.</p></td>
</tr>
<tr class="row-even"><td><p>Hostname:</p></td>
<td><p>This is the FQDN of the server to be installed. It is required.</p></td>
</tr>
<tr class="row-odd"><td><p>Root password:</p></td>
<td><p>If you don’t put anything here it will default to the salted MD5 of “Fred”. Whatever put is MD5 hashed and writte to disk.</p></td>
</tr>
<tr class="row-even"><td><p>DHCP:</p></td>
<td><p>if yes, other IP settings will be ignored</p></td>
</tr>
<tr class="row-odd"><td><p>IP Address:</p></td>
<td><p>Required if DHCP=no</p></td>
</tr>
<tr class="row-even"><td><p>Netmask:</p></td>
<td><p>Required if DHCP=no</p></td>
</tr>
<tr class="row-odd"><td><p>Gateway:</p></td>
<td><p>Required if DHCP=no</p></td>
</tr>
<tr class="row-even"><td><p>IPV6 Address:</p></td>
<td><p>Optional. /64 is assumed if prefix is omitted</p></td>
</tr>
<tr class="row-odd"><td><p>IPV6 Gateway:</p></td>
<td><p>Ignored if an IPV4 gateway is specified</p></td>
</tr>
<tr class="row-even"><td><p>Network Device:</p></td>
<td><p>Optional. Typical values are bond0, eth4, etc. Note: if you enter bond0, a LACP bonding config will be written</p></td>
</tr>
<tr class="row-odd"><td><p>MTU:</p></td>
<td><p>If unsure, set to 1500</p></td>
</tr>
<tr class="row-even"><td><p>Specify disk for OS install:</p></td>
<td><p>Optional. Typical values are “sda”.</p></td>
</tr>
</tbody>
</table>
<p>When you click the <strong>Download ISO</strong> button the folling occurs (all paths relative to the top level of the directory specified in _osversions.cfg_):</p>
<ol class="arabic simple">
<li><p>Reads /etc/resolv.conf to get a list of nameservers. This is a rather ugly hack that is in place until we get a way of configuring it in the interface.</p></li>
<li><p>Writes a file in the ks_scripts/state.out that contains directory from _osversions.cfg_ and the mkisofs string that we’ll call later.</p></li>
<li><p>Writes a file in the ks_scripts/network.cfg that is a bunch of key=value pairs that set up networking.</p></li>
<li><p>Creates an MD5 hash of the password you specify and writes it to ks_scripts/password.cfg. Note that if you do not specify a password “Fred” is used. Also note that we have experienced some issues with webbrowsers autofilling that field.</p></li>
<li><p>Writes out a disk configuration file to ks_scripts/disk.cfg.</p></li>
<li><p>mkisofs is called against the directory configured in _osversions.cfg_ and an ISO is generated in memory and delivered to your webbrowser.</p></li>
</ol>
<p>You now have a customized ISO that can be used to install Red Hat and derivative Linux installations with some modifications to your ks.cfg file.</p>
<p>Kickstart/Anaconda will mount the ISO at /mnt/stage2 during the install process (at least with 6).</p>
<p>You can directly include the password file anywhere in your ks.cfg file (usually in the top) by doing %include /mnt/stage2/ks_scripts/password.cfg</p>
<p>What we currently do is have 2 scripts, one to do hard drive configuration and one to do network configuration. Both are relatively specific to the environment they were created in, and both are <em>probably</em> wrong for other organizations, however they are currently living in the “misc” directory as examples of how to do things.</p>
<p>We trigger those in a %pre section in ks.cfg and they will write config files to /tmp. We will then include those files in the appropriate places using  %pre.</p>
<p>For example this is a section of our ks.cfg file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">include</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stage2</span><span class="o">/</span><span class="n">ks_scripts</span><span class="o">/</span><span class="n">packages</span><span class="o">.</span><span class="n">txt</span>

<span class="o">%</span><span class="n">pre</span>
        <span class="n">python</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stage2</span><span class="o">/</span><span class="n">ks_scripts</span><span class="o">/</span><span class="n">create_network_line</span><span class="o">.</span><span class="n">py</span>
        <span class="n">bash</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stage2</span><span class="o">/</span><span class="n">ks_scripts</span><span class="o">/</span><span class="n">drive_config</span><span class="o">.</span><span class="n">sh</span>
<span class="o">%</span><span class="n">end</span>
</pre></div>
</div>
<p>These two scripts will then run _before_ anaconda sets up it’s internal structures, then a bit further up in the ks.cfg file (outside of the %pre %end block) we do an</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">include</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">stage2</span><span class="o">/</span><span class="n">ks_scripts</span><span class="o">/</span><span class="n">password</span><span class="o">.</span><span class="n">cfg</span>
<span class="o">...</span>
<span class="o">%</span><span class="n">include</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">network_line</span>

<span class="o">%</span><span class="n">include</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">drive_config</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This snarfs up the contents and inlines them.</p>
<p>If you only have one kind of hardware on your CDN it is probably best to just put the drive config right in the ks.cfg.</p>
<p>If you have simple networking needs (we use bonded interfaces in most, but not all locations and we have several types of hardware meaning different ethernet interface names at the OS level etc.) then something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">source</span> /mnt/stage2/ks_scripts/network.cfg
<span class="nb">echo</span> <span class="s2">&quot;network --bootproto=static --activate --ipv6=</span><span class="nv">$IPV6ADDR</span><span class="s2"> --ip=</span><span class="nv">$IPADDR</span><span class="s2"> --netmask=</span><span class="nv">$NETMASK</span><span class="s2"> --gateway=</span><span class="nv">$GATEWAY</span><span class="s2"> --ipv6gateway=</span><span class="nv">$GATEWAY</span><span class="s2"> --nameserver=</span><span class="nv">$NAMESERVER</span><span class="s2"> --mtu=</span><span class="nv">$MTU</span><span class="s2"> --hostname=</span><span class="nv">$HOSTNAME</span><span class="s2">&quot;</span> &gt;&gt; /tmp/network.cfg
</pre></div>
</div>
<p>,, Note:: that this is an example and may not work at all.</p>
<p>You could also put this in the %pre section. Lots of ways to solve it.</p>
<p>We have included the two scripts we use in the “misc” directory of the git repo:</p>
<ul class="simple">
<li><p>kickstart_create_network_line.py</p></li>
<li><p>kickstart_drive_config.sh</p></li>
</ul>
<p>These scripts were written to support a very narrow set of expectations and environment and are almost certainly not suitable to just drop in, but they might provide a good starting point.</p>
</div>
<div class="section" id="queue-updates-and-snapshot-crconfig">
<span id="queue-updates"></span><h3>Queue Updates and Snapshot CRConfig<a class="headerlink" href="#queue-updates-and-snapshot-crconfig" title="Permalink to this headline">¶</a></h3>
<p>When changing delivery services special care has to be taken so that Traffic Router will not send traffic to caches for delivery services that the cache doesn’t know about yet. In general, when adding delivery services, or adding servers to a delivery service, it is best to update the caches before updating Traffic Router and Traffic Monitor. When deleting delivery services, or deleting server assignments to delivery services, it is best to update Traffic Router and Traffic Monitor first and then the caches. Updating the cache configuration is done through the <em>Queue Updates</em> menu, and updating Traffic Monitor and  Traffic Router config is done through the <em>Snapshot CRConfig</em> menu.</p>
<div class="section" id="index-11">
<span id="id18"></span><h4>Queue Updates<a class="headerlink" href="#index-11" title="Permalink to this headline">¶</a></h4>
<p>Every 15 minutes the caches should run a <em>syncds</em> to get all changes needed from Traffic Ops. The files that will be updated by the syncds job are:</p>
<ul class="simple">
<li><p>records.config</p></li>
<li><p>remap.config</p></li>
<li><p>parent.config</p></li>
<li><p>cache.config</p></li>
<li><p>hosting.config</p></li>
<li><p>url_sig_(.*).config</p></li>
<li><p>hdr_rw_(.*).config</p></li>
<li><p>regex_revalidate.config</p></li>
<li><p>ip_allow.config</p></li>
</ul>
<p>A cache will only get updated when the update flag is set for it. To set the update flag, use the <em>Queue Updates</em> menu - here you can schedule updates for a whole CDN or a cache group:</p>
<ol class="arabic simple">
<li><p>Click <strong>Tools &gt; Queue Updates</strong>.</p></li>
<li><p>Select the CDN to queueu uodates for, or All.</p></li>
<li><p>Select the cache group to queue updates for, or All</p></li>
<li><p>Click the <strong>Queue Updates</strong> button.</p></li>
<li><p>When the Queue Updates for this Server? (all) window opens, click <strong>OK</strong>.</p></li>
</ol>
<p>To schedule updates for just one cache, use the “Server Checks” page, and click the <img alt="checkmark" src="../../_images/good.png" /> in the <em>UPD</em> column. The UPD column of Server Checks page will change show a <img alt="clock" src="../../_images/clock-black.png" /> when updates are pending for that cache.</p>
</div>
<div class="section" id="snapshot-crconfig">
<span id="index-12"></span><span id="id19"></span><h4>Snapshot CRConfig<a class="headerlink" href="#snapshot-crconfig" title="Permalink to this headline">¶</a></h4>
<p>Every 60 seconds Traffic Monitor will check with Traffic Ops to see if a new CRConfig snapshot exists; Traffic Monitor polls Traffic Ops for a new CRConfig, and Traffic Router polls Traffic Monitor for the same file. This is necessary to ensure that Traffic Monitor sees configuration changes first, which helps to ensure that the health and state of caches and delivery services propagates properly to Traffic Router. See <a class="reference internal" href="#ccr-profile"><span class="std std-ref">Traffic Router Profile</span></a> for more information on the CRConfig file.</p>
<p>To create a new snapshot, use the <em>Tools &gt; Snapshot CRConfig</em> menu:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Click <strong>Tools &gt; Snapshot CRConfig</strong>.</p></li>
<li><dl>
<dt>Verify the selection of the correct CDN from the Choose CDN drop down and click <strong>Diff CRConfig</strong>.</dt><dd><p>On initial selection of this, the CRConfig Diff window says the following:</p>
<p>There is no existing CRConfig for [cdn] to diff against… Is this the first snapshot???
If you are not sure why you are getting this message, please do not proceed!
To proceed writing the snapshot anyway click the ‘Write CRConfig’ button below.</p>
<p>If there is an older version of the CRConfig, a window will pop up showing the differences
between the active CRConfig and the CRConfig about to be written.</p>
</dd>
</dl>
</li>
<li><p>Click <strong>Write CRConfig</strong>.</p></li>
<li><p>When the This will push out a new CRConfig.json. Are you sure? window opens, click <strong>OK</strong>.</p></li>
<li><p>The Successfully wrote CRConfig.json! window opens, click <strong>OK</strong>.</p></li>
</ol>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="invalidate-content">
<span id="purge"></span><span id="index-13"></span><h2>Invalidate Content<a class="headerlink" href="#invalidate-content" title="Permalink to this headline">¶</a></h2>
<p>Invalidating content on the CDN is sometimes necessary when the origin was mis-configured and something is cached in the CDN  that needs to be removed. Given the size of a typical Traffic Control CDN and the amount of content that can be cached in it, removing the content from all the caches may take a long time. To speed up content invalidation, Traffic Ops will not try to remove the content from the caches, but it makes the content inaccessible using the <em>regex_revalidate</em> ATS plugin. This forces a <em>revalidation</em> of the content, rather than a new get.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method forces a HTTP <em>revalidation</em> of the content, and not a new <em>GET</em> - the origin needs to support revalidation according to the HTTP/1.1 specification, and send a <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> or <code class="docutils literal notranslate"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></code> as applicable.</p>
</div>
<p>To invalidate content:</p>
<ol class="arabic">
<li><p>Click <strong>Tools &gt; Invalidate Content</strong></p></li>
<li><p>Fill out the form fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>Select the <strong>Delivery Service</strong></p></li>
<li><p>Enter the <strong>Path Regex</strong> - this should be a <a class="reference external" href="http://www.pcre.org/">PCRE</a> compatible regular expression for the path to match for forcing the revalidation. Be careful to only match on the content you need to remove - revalidation is an expensive operation for many origins, and a simple <code class="docutils literal notranslate"><span class="pre">/.*</span></code> can cause an overload condition of the origin.</p></li>
<li><p>Enter the <strong>Time To Live</strong> - this is how long the revalidation rule will be active for. It usually makes sense to make this the same as the <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> header from the origin which sets the object time to live in cache (by <code class="docutils literal notranslate"><span class="pre">max-age</span></code> or <code class="docutils literal notranslate"><span class="pre">Expires</span></code>). Entering a longer TTL here will make the caches do unnecessary work.</p></li>
<li><p>Enter the <strong>Start Time</strong> - this is the start time when the revalidation rule will be made active. It is pre-populated with the current time, leave as is to schedule ASAP.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Click the <strong>Submit</strong> button.</p></li>
</ol>
</div>
<div class="section" id="manage-dnssec-keys">
<h2>Manage DNSSEC Keys<a class="headerlink" href="#manage-dnssec-keys" title="Permalink to this headline">¶</a></h2>
<p>In order to support <a class="reference external" href="https://en.wikipedia.org/wiki/Domain_Name_System_Security_Extensions">DNSSEC</a> in Traffic Router, Traffic Ops provides some actions for managing DNSSEC keys for a CDN and associated Delivery Services.  DNSSEC Keys consist of a Key Signing Keys (KSK) which are used to sign other DNSKEY records as well as Zone Signing Keys (ZSK) which are used to sign other records.  DNSSEC Keys are stored in <a class="reference external" href="../../overview/traffic_vault.html">Traffic Vault</a> and should only be accessible to Traffic Ops.  Other applications needing access to this data, such as Traffic Router, must use the Traffic Ops <a class="reference external" href="../../development/traffic_ops_api/v12/cdn.html#dnssec-keys">DNSSEC APIs</a> to retrieve this information.</p>
<p>To Manage DNSSEC Keys:
1. Click <strong>Tools -&gt; Manage DNSSEC Keys</strong>
2. Choose a CDN and click <strong>Manage DNSSEC Keys</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>If keys have not yet been generated for a CDN, this screen will be mostly blank with just the <strong>CDN</strong> and <strong>DNSSEC Active?</strong> fields being populated.</p></li>
<li><p>If keys have been generated for the CDN, the Manage DNSSEC Keys screen will show the TTL and Top Level Domain (TLD) KSK Expiration for the CDN as well as DS Record information which will need to be added to the parent zone of the TLD in order for DNSSEC to work.</p></li>
</ul>
</div></blockquote>
<p>The Manage DNSSEC Keys screen also allows a user to perform the following actions:</p>
<div class="section" id="activate-deactivate-dnssec-for-a-cdn">
<h3>Activate/Deactivate DNSSEC for a CDN<a class="headerlink" href="#activate-deactivate-dnssec-for-a-cdn" title="Permalink to this headline">¶</a></h3>
<p>Fairly straight forward, this button set the <strong>dnssec.enabled</strong> param to either <strong>true</strong> or <strong>false</strong> on the Traffic Router profile for the CDN.  The Activate/Deactivate option is only available if DNSSEC keys exist for CDN.  In order to active DNSSEC for a CDN a user must first generate keys and then click the <strong>Active DNSSEC</strong> button.</p>
</div>
<div class="section" id="generate-keys">
<h3>Generate Keys<a class="headerlink" href="#generate-keys" title="Permalink to this headline">¶</a></h3>
<p>Generate Keys will generate DNSSEC keys for the CDN TLD as well as for each Delivery Service in the CDN.  It is important to note that this button will create a new KSK for the TLD and, therefore, a new DS Record.  Any time a new DS Record is created, it will need to be added to the parent zone of the TLD in order for DNSSEC to work properly.  When a user clicks the <strong>Generate Keys</strong> button, they will be presented with a screen with the following fields:</p>
<ul class="simple">
<li><p><strong>CDN:</strong> This is not editable and displays the CDN for which keys will be generated</p></li>
<li><p><strong>ZSK Expiration (Days):</strong>  Sets how long (in days) the Zone Signing Key will be valid for the CDN and associated Delivery Services. The default is 30 days.</p></li>
<li><p><strong>KSK Expiration (Days):</strong>  Sets how long (in days) the Key Signing Key will be valid for the CDN and associated Delivery Services. The default is 365 days.</p></li>
<li><p><strong>Effective Date (GMT):</strong> The time from which the new keys will be active.  Traffic Router will use this value to determine when to start signing with the new keys and stop signing with the old keys.</p></li>
</ul>
<p>Once these fields have been correctly entered, a user can click Generate Keys.  The user will be presented with a confirmation screen to help them understand the impact of generating the keys.  If a user confirms, the keys will be generated and stored in Traffic Vault.</p>
</div>
<div class="section" id="regenerate-ksk">
<h3>Regenerate KSK<a class="headerlink" href="#regenerate-ksk" title="Permalink to this headline">¶</a></h3>
<p>Regenerate KSK will create a new Key Signing Key for the CDN TLD. A new DS Record will also be generated and need to be put into the parent zone in order for DNSSEC to work correctly. The <strong>Regenerate KSK</strong> button is only available if keys have already been generated for a CDN.  The intent of the button is to provide a mechanism for generating a new KSK when a previous one expires or if necessary for other reasons such as a security breach.  When a user goes to generate a new KSK they are presented with a screen with the following options:</p>
<dl class="field-list simple">
<dt class="field-odd">CDN</dt>
<dd class="field-odd"><p>This is not editable and displays the CDN for which keys will be generated</p>
</dd>
<dt class="field-even">KSK Expiration (Days)</dt>
<dd class="field-even"><p>Sets how long (in days) the Key Signing Key will be valid for the CDN and associated Delivery Services. The default is 365 days.</p>
</dd>
<dt class="field-odd">Effective Date (GMT)</dt>
<dd class="field-odd"><p>The time from which the new KSK and DS Record will be active.  Since generating a new KSK will generate a new DS Record that needs to be added to the parent zone, it is very important to make sure that an effective date is chosen that allows for time to get the DS Record into the parent zone.  Failure to get the new DS Record into the parent zone in time could result in DNSSEC errors when Traffic Router tries to sign responses.</p>
</dd>
</dl>
<p>Once these fields have been correctly entered, a user can click Generate KSK.  The user will be presented with a confirmation screen to help them understand the impact of generating the KSK.  If a user confirms, the KSK will be generated and stored in Traffic Vault.</p>
<p>Additionally, Traffic Ops also performs some systematic management of DNSSEC keys.  This management is necessary to help keep keys in sync for Delivery Services in a CDN as well as to make sure keys do not expire without human intervention.</p>
</div>
<div class="section" id="generation-of-keys-for-new-delivery-services">
<h3>Generation of keys for new Delivery Services<a class="headerlink" href="#generation-of-keys-for-new-delivery-services" title="Permalink to this headline">¶</a></h3>
<p>If a new Delivery Service is created and added to a CDN that has DNSSEC enabled, Traffic Ops will create DNSSEC keys for the Delivery Service and store them in Traffic Vault.</p>
</div>
<div class="section" id="regeneration-of-expiring-keys-for-a-delivery-service">
<h3>Regeneration of expiring keys for a Delivery Service<a class="headerlink" href="#regeneration-of-expiring-keys-for-a-delivery-service" title="Permalink to this headline">¶</a></h3>
<p>Traffic Ops has a process, controlled by cron, to check for expired or expiring keys and re-generate them.  The process runs at 5 minute intervals to check and see if keys are expired or close to expiring (withing 10 minutes by default).  If keys are expired for a Delivery Service, traffic ops will regenerate new keys and store them in Traffic Vault.  This process is the same for the CDN TLD ZSK, however Traffic Ops will not re-generate the CDN TLD KSK systematically.  The reason is that when a KSK is regenerated for the CDN TLD then a new DS Record will also be created.  The new DS Record needs to be added to the parent zone before Traffic Router attempts to sign with the new KSK in order for DNSSEC to work correctly.  Therefore, management of the KSK needs to be a manual process.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="extensions.html" class="btn btn-neutral float-right" title="Managing Traffic Ops Extensions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral float-left" title="Traffic Ops - Configuring" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Apache Traffic Control

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>